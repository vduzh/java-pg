allprojects {
    group = 'by.duzh.java'
    version = '1.0-SNAPSHOT'

    repositories {
        mavenCentral()
    }

    plugins.withId('java') {
        java {
            toolchain {
                languageVersion = JavaLanguageVersion.of(libs.versions.java.get())
            }
        }
    }
}

//subprojects {
//    apply plugin: 'java'
////    apply plugin: 'idea'
//
//    sourceCompatibility = '21'
//    targetCompatibility = '21'
//
//    dependencies {
//        testImplementation 'org.junit.jupiter:junit-jupiter-api:5.10.0'
//        testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.10.0'
//    }
//
//    test {
//        useJUnitPlatform()
//    }
//
////    // Задача для запуска миграций для jpa-core
////    task runJpaCoreMigrations(type: GradleBuild) {
////        group = 'Liquibase'
////        description = 'Запуск миграций для jpa-core'
////        dir = file('db-migrations/jpa-core')  // Путь к подпроекту jpa-core
////        tasks = ['runLiquibase']  // Задача для выполнения в подмодуле jpa-core
////    }
//}

tasks.register('runMigrations') {
    group = 'db-migrations'
    description = 'Run migrations for db-migrations'
    dependsOn ':db-migrations:updateAll'
}
